<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Wenrui Hu" />

<meta name="date" content="2024-12-07" />

<title>Homework Answer</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Answer</h1>
<h4 class="author">Wenrui Hu</h4>
<h4 class="date">2024-12-07</h4>



<div id="section" class="section level1">
<h1>2024.09.09</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples. For each example,texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>I will give three examples.Some will mix with figures ,tables and
mathematical formulas.</p>
</div>
<div id="example1" class="section level2">
<h2>Example1</h2>
<p>Firstly, I will reappear the regression analysis part in”Anskum
Anscombe Quartet”</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>anscombe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="at">x1=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>),</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">x2=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="at">x3=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">x4=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">19</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>),</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">y1=</span><span class="fu">c</span>(<span class="fl">8.04</span>,<span class="fl">6.95</span>,<span class="fl">7.58</span>,<span class="fl">8.81</span>,<span class="fl">8.33</span>,<span class="fl">9.96</span>,<span class="fl">7.24</span>,<span class="fl">4.26</span>,<span class="fl">10.84</span>,<span class="fl">4.82</span>,<span class="fl">5.68</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">y2=</span><span class="fu">c</span>(<span class="fl">9.14</span>,<span class="fl">8.14</span>,<span class="fl">8.74</span>,<span class="fl">8.77</span>,<span class="fl">9.26</span>,<span class="fl">8.1</span>,<span class="fl">6.13</span>,<span class="fl">3.1</span>,<span class="fl">9.13</span>,<span class="fl">7.26</span>,<span class="fl">4.74</span>),</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">y3=</span><span class="fu">c</span>(<span class="fl">7.46</span>,<span class="fl">6.77</span>,<span class="fl">12.74</span>,<span class="fl">7.11</span>,<span class="fl">7.81</span>,<span class="fl">8.84</span>,<span class="fl">6.08</span>,<span class="fl">5.39</span>,<span class="fl">8.15</span>,<span class="fl">6.42</span>,<span class="fl">5.73</span>),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">y4=</span><span class="fu">c</span>(<span class="fl">6.58</span>,<span class="fl">5.76</span>,<span class="fl">7.71</span>,<span class="fl">8.84</span>,<span class="fl">8.47</span>,<span class="fl">7.04</span>,<span class="fl">5.25</span>,<span class="fl">12.5</span>,<span class="fl">5.56</span>,<span class="fl">7.91</span>,<span class="fl">6.89</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="co"># show results from four regression analyses</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y1<span class="sc">~</span>x1))))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y1 ~ x1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.92127 -0.45577 -0.04136  0.70941  1.83882 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   3.0001     1.1247   2.667  0.02573 * 
## x1            0.5001     0.1179   4.241  0.00217 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.237 on 9 degrees of freedom
## Multiple R-squared:  0.6665, Adjusted R-squared:  0.6295 
## F-statistic: 17.99 on 1 and 9 DF,  p-value: 0.00217</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y2<span class="sc">~</span>x2))))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y2 ~ x2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9009 -0.7609  0.1291  0.9491  1.2691 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    3.001      1.125   2.667  0.02576 * 
## x2             0.500      0.118   4.239  0.00218 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.237 on 9 degrees of freedom
## Multiple R-squared:  0.6662, Adjusted R-squared:  0.6292 
## F-statistic: 17.97 on 1 and 9 DF,  p-value: 0.002179</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y3<span class="sc">~</span>x3))))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y3 ~ x3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.1586 -0.6146 -0.2303  0.1540  3.2411 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   3.0025     1.1245   2.670  0.02562 * 
## x3            0.4997     0.1179   4.239  0.00218 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.236 on 9 degrees of freedom
## Multiple R-squared:  0.6663, Adjusted R-squared:  0.6292 
## F-statistic: 17.97 on 1 and 9 DF,  p-value: 0.002176</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y4<span class="sc">~</span>x4))))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y4 ~ x4)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.751 -0.831  0.000  0.809  1.839 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   3.0017     1.1239   2.671  0.02559 * 
## x4            0.4999     0.1178   4.243  0.00216 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.236 on 9 degrees of freedom
## Multiple R-squared:  0.6667, Adjusted R-squared:  0.6297 
## F-statistic:    18 on 1 and 9 DF,  p-value: 0.002165</code></pre>
</div>
<div id="example2" class="section level2">
<h2>Example2</h2>
<p>Then，we will continue to use “Anskum Anscombe Quartet” for data
analysis.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>  y1<span class="ot">=</span><span class="fu">c</span>(<span class="fl">8.04</span>,<span class="fl">6.95</span>,<span class="fl">7.58</span>,<span class="fl">8.81</span>,<span class="fl">8.33</span>,<span class="fl">9.96</span>,<span class="fl">7.24</span>,<span class="fl">4.26</span>,<span class="fl">10.84</span>,<span class="fl">4.82</span>,<span class="fl">5.68</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  y2<span class="ot">=</span><span class="fu">c</span>(<span class="fl">9.14</span>,<span class="fl">8.14</span>,<span class="fl">8.74</span>,<span class="fl">8.77</span>,<span class="fl">9.26</span>,<span class="fl">8.1</span>,<span class="fl">6.13</span>,<span class="fl">3.1</span>,<span class="fl">9.13</span>,<span class="fl">7.26</span>,<span class="fl">4.74</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  y3<span class="ot">=</span><span class="fu">c</span>(<span class="fl">7.46</span>,<span class="fl">6.77</span>,<span class="fl">12.74</span>,<span class="fl">7.11</span>,<span class="fl">7.81</span>,<span class="fl">8.84</span>,<span class="fl">6.08</span>,<span class="fl">5.39</span>,<span class="fl">8.15</span>,<span class="fl">6.42</span>,<span class="fl">5.73</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  y4<span class="ot">=</span><span class="fu">c</span>(<span class="fl">6.58</span>,<span class="fl">5.76</span>,<span class="fl">7.71</span>,<span class="fl">8.84</span>,<span class="fl">8.47</span>,<span class="fl">7.04</span>,<span class="fl">5.25</span>,<span class="fl">12.5</span>,<span class="fl">5.56</span>,<span class="fl">7.91</span>,<span class="fl">6.89</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  fs<span class="ot">=</span><span class="fu">c</span>(y1,y2,y3,y4)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="fu">mean</span>(fs)</span></code></pre></div>
<pre><code>## [1] 7.500682</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>  <span class="fu">median</span>(fs)</span></code></pre></div>
<pre><code>## [1] 7.52</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>  <span class="fu">quantile</span>(fs,<span class="at">probs=</span>(<span class="fl">0.25</span>))</span></code></pre></div>
<pre><code>##    25% 
## 6.1175</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>  <span class="fu">quantile</span>(fs,<span class="at">probs=</span>(<span class="fl">0.75</span>))</span></code></pre></div>
<pre><code>##    75% 
## 8.7475</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>  <span class="fu">hist</span>(fs)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example3" class="section level2">
<h2>Example3</h2>
<p>Finally,I will reappear chart in”Anskum Anscombe Quartet”</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>anscombe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="at">x1=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>),</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="at">x2=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="at">x3=</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">8</span>,<span class="dv">13</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">12</span>,<span class="dv">7</span>,<span class="dv">5</span>),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="at">x4=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">19</span>,<span class="dv">8</span>,<span class="dv">8</span>,<span class="dv">8</span>),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="at">y1=</span><span class="fu">c</span>(<span class="fl">8.04</span>,<span class="fl">6.95</span>,<span class="fl">7.58</span>,<span class="fl">8.81</span>,<span class="fl">8.33</span>,<span class="fl">9.96</span>,<span class="fl">7.24</span>,<span class="fl">4.26</span>,<span class="fl">10.84</span>,<span class="fl">4.82</span>,<span class="fl">5.68</span>),</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  <span class="at">y2=</span><span class="fu">c</span>(<span class="fl">9.14</span>,<span class="fl">8.14</span>,<span class="fl">8.74</span>,<span class="fl">8.77</span>,<span class="fl">9.26</span>,<span class="fl">8.1</span>,<span class="fl">6.13</span>,<span class="fl">3.1</span>,<span class="fl">9.13</span>,<span class="fl">7.26</span>,<span class="fl">4.74</span>),</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  <span class="at">y3=</span><span class="fu">c</span>(<span class="fl">7.46</span>,<span class="fl">6.77</span>,<span class="fl">12.74</span>,<span class="fl">7.11</span>,<span class="fl">7.81</span>,<span class="fl">8.84</span>,<span class="fl">6.08</span>,<span class="fl">5.39</span>,<span class="fl">8.15</span>,<span class="fl">6.42</span>,<span class="fl">5.73</span>),</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  <span class="at">y4=</span><span class="fu">c</span>(<span class="fl">6.58</span>,<span class="fl">5.76</span>,<span class="fl">7.71</span>,<span class="fl">8.84</span>,<span class="fl">8.47</span>,<span class="fl">7.04</span>,<span class="fl">5.25</span>,<span class="fl">12.5</span>,<span class="fl">5.56</span>,<span class="fl">7.91</span>,<span class="fl">6.89</span>)</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file=</span><span class="st">&quot;fig_more_anscombe.pdf&quot;</span>,<span class="at">width =</span> <span class="fl">8.5</span>,<span class="at">height =</span> <span class="fl">8.5</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">plot</span>(x1,y1,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>),<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">las=</span><span class="dv">1</span>))</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Set 1&quot;</span>)</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">plot</span>(x2,y2,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>),<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">las=</span><span class="dv">1</span>))</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Set 2&quot;</span>)</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">plot</span>(x3,y3,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>),<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">las=</span><span class="dv">1</span>))</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Set 3&quot;</span>)</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="fu">with</span>(anscombe,<span class="fu">plot</span>(x4,y4,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">20</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">14</span>),<span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">las=</span><span class="dv">1</span>))</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Set 4&quot;</span>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2024.09.14</h1>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[
f\left ( x \right ) =\frac{x}{\sigma ^{2} }  e^{\frac{-x ^{2}}{2\sigma
^{2}} } ,x\ge 0,\sigma&gt; 0.\]</span> Develop an algorithm to generate
random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ)
samples for several choices of σ&gt; 0 and check that the mode of the
generated samples is close to the theoretical mode σ (check the
histogram).</p>
</div>
<div id="answer1" class="section level2">
<h2>Answer1</h2>
<p>We can generate random samples from a Rayleigh(σ) distribution
through the inverse transform method.Firstly, we can get <span class="math display">\[F\left ( x \right ) = 1-e^{\frac{-x ^{2}}{2\sigma
^{2}} } ,\sigma&gt; 0.\]</span>,and we can deduce<span class="math display">\[ F^{-1} \left ( u \right ) =\sqrt{-2 \sigma
^{2}\ln{(1-u)}  }  \]</span>.Then we generate a uniformly distributed
random number u and substitute it to get the Rayleigh(σ) distributed
random number.In the end,graph the density histogram of the sample with
several choices of σ&gt; 0 density superimposed for comparison.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>x<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="co">#F(x)=1-e^(-(x^2)/2*t^2)</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">/</span>(t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">1</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>t<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>x<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="co">#F(x)=1-e^(-(x^2)/2*t^2)</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">/</span>(t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,.<span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>x<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="co">#F(x)=1-e^(-(x^2)/2*t^2)</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span>x<span class="sc">/</span>(t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(t<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Through these images, we can see that when σ is too big or too small,
the effect is not very good, and when σ is moderate, the effect is
better.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have <span class="math inline">\(N\left (
0,1 \right )\)</span> and <span class="math inline">\(N\left ( 3,1
\right )\)</span> distributions with mixing probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2} = 1-p_{1}\)</span> . Graph the histogram of
the sample with density superimposed, for <span class="math inline">\(p_{1} = 0.75\)</span>. Repeat with different
values for <span class="math inline">\(p_{1}\)</span> and observe
whether the empirical distribution of the mixture appears to be bimodal.
Make a conjecture about the values of <span class="math inline">\(p_{1}\)</span> that produce bimodal mixtures.</p>
</div>
<div id="answer2" class="section level2">
<h2>Answer2</h2>
<p>First, we can generate random numbers from the <span class="math inline">\(N\left ( 0,1 \right )\)</span> and <span class="math inline">\(N\left ( 3,1 \right )\)</span> distributions
through Box-Muller transformation and linear transformation of normal
distribution.Then mix it according to different ratios to get the random
number.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.75</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>z1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>z2<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)<span class="sc">+</span><span class="dv">3</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>x<span class="ot">&lt;-</span> r<span class="sc">*</span>z1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>z2</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.75</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6OgA6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmZmZmkLZmtv+QOgCQOjqQZgCQZjqQkGaQttuQ2/+2ZgC2Zjq2kDq2kGa22/+2/7a2/9u2///T09PbkDrbtpDb/9vb////tmb/25D/27b//7b//9v///9ZIqEZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHyUlEQVR4nO2d63qjNhRFccZxL9NJesm4tzDTdDq0JjG8/9sVEDgOBm0JJHQs9vqRz0nkg7WsGyCkpCRaktAfQDoUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQBRgo53H0f+U/y1SzYPh1O6RHHzT1lm6uXYO+ciSdDxx9Fspo2E2y7huaB0NYL+3Y1mM0/ePZUvfX9Z/Xux3x6G3+QGMYKKX5N3f4wJSjeP1c/n3e35H9Wvx7vb4fc4Iqyg9ObLpyT57ql6ebx/OOQjgtpS8rawFPu6glWaPnj9iKEF/Vy3H035KOuaNCyoKyVpo6QlSz6o9zz8lCTfP/n6iIEFJZs/y+JT1/raCDreqeLUdmKdY+cEFtTkq60s54LarqntuIYE5aoAVSl/OJw5dk7oKtbkOGu/f5sS9Ka6vTp2zlUIGmik+51XGqkgsyo20M13SdumyN9oKHQjXQ0AcSM9MFDsCl0V4v2hfNknvjr70CXo2+6MoWZU0NmpRmvmVKXa0w5vw+nQbdCX36tBTJe5cUHF5+5kNWtr5cnISxVh897b6UZoQZ6aVndQEICCABQEEHO5QyoUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQA7QcX+9TGklWAlKOvmkubeJpWKw0ZQsT9pyfw+pCUIG0FnT0zmMipZcoH7Q1iklVeCkq89wgpSz0DWSGmDpAk6PU0ro/wIFCQNCgIIE3S8q1ueXNBAUaKgpv8aXyJhWQQKatWwmx+iFvS8awT1BooeB2paBAoCJWjtgrrH/lRzPTOcNZcnFsIElY2jzaNmIO1XUF/HV3mCFg7XC05BIHhQQVXlwas7ZN1KRtnIUDFiQSr3+pP0+oljteTBKgWVyJG6HtQ8kb1WQUrR2JlWd4KRbg8rFZQ3TczoOhinK4rp7RoF1cNAZWb0gnOnpUq6PkHHO4NFnLprrqPL9UQsSGS4XvDAgqq2d/bV+JgFpU0DNHNZwogFdX34vFuCEQvq+vCxDtwynA8CVzHVQ81c2DJmQZWbyQs2LnPJNbQggeF6wSkIBA8ryMnssZgFOVkNKmJBozcqpoXzQWhBLu4mRyyo2LtYcDhiQZplMCeF80DoKpawFxs6qOhwveAUBIIHFlRVsu0h5QWz3kFPr/LNY7Y9zBwORSyovh6UaW4JWobzQehe7GMjiFcUewftXnQlKJ01+zBiQW0blM0bLsYsSA0VZ24BE7WgOVF4yTVMuF7woIJ4LjZy0N7vMx8ljF9QmYq59YxnRQcRJGegeJl7EYLknGrIFKSf3QFvDUUsyORxVLywQMSCDDB4LHzdggwWFohY0GmgON7ErLwEqds+2rN5vLBAxIKKvcq89mlU2JJHLOh4327lyXHQ20/RvehKkJwrisIE1VcUy7PtOQdZ80CxbWC05YcDRT3X0M07X3LJzUDRyyXXSYIuk8z9FK8v4a3nayhBHgUZ3Hr2OlA0WDUgqCCjW88+B4o4s2EFBb/1LF1Q8FvP0gUFv/UsXtCyt54HBiziBUEMLhmZC5qQ2fBtEGL0YefLcPC4VyfIaKY9nG0esSCz/h3NNo9Y0MKTF65PkBsoyFW4KxPkbGXNqAWZdPRm4UwSUhBISEEg4boE2V9yXZmgXjiThBQEEl6bIHiebhPOJOF1CXIGBbkKR0G9v8Prh2sX5CKzFERBFERBE8MFFDRzPkz8gi7+4CZHE6GgieHWIshwEueU+8pRCDKdxOkoJy7es6gg4yl4axVkPIlzoIoJwp8geduILoBlGyRsG9EFsCtw0rYRXQD3c/cjYyFBYZvlt1h+cj9CJhwGJ3ESxDbHFOQ2+VQoaP5hKGh2EgpaIggFOUgyI/lUKGj+YdYt6HqhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgGUENdNmdDdjc7TmA4ygQCuP1Ful2i2YvYigYl/lPtN8snqBuVxnCEZo44B7vnn1b8vdrBcR9LxrFvkcnXalZkXo1kJHERTNGlqa/6vj2K2YvWAbNF5EzLKvi6DItr9pBT1/Y790y4KCxvcpVR8cL/0AdjqtwujboPzm7zuTluyc5QRppsyokoHKB5p0U1cgvaCsnlxpudvlYoJy0EZjQboINXj9LLXMqN0iZEsJ0n77RlUMTdpqggBBzRFUi2eKb0GZGr5k2tyZNNL6CO2RajS5V1+BXVO9TAkCK6Phbh5F6NCXIDULVWAVe96Bbx8OFGGEFjCSrpspy4e7FxHUln6NgQycauAICnSqkRudsJzDk1UABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBAuqB62pl2c1zfSBfU7W4aDOmC6rnN9/N27pyHeEFlavn0iWPkC0LbKnpGvKBi/8usvWLmIl5Qtv3PwZ5D05EuqJ7aPG8D85lIF5Q2M5sDNtPSBQWHggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC/A848CeCkSeqiwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.6</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>z1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>z2<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)<span class="sc">+</span><span class="dv">3</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>x<span class="ot">&lt;-</span> r<span class="sc">*</span>z1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>z2</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>z1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>z2<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)<span class="sc">+</span><span class="dv">3</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>x<span class="ot">&lt;-</span> r<span class="sc">*</span>z1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>z2</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.4</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>z1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>z2<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)<span class="sc">+</span><span class="dv">3</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>x<span class="ot">&lt;-</span> r<span class="sc">*</span>z1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>z2</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.4</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fl">0.25</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>p1</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>z1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>z2<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">*</span>v)<span class="sc">+</span><span class="dv">3</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,p2))</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>x<span class="ot">&lt;-</span> r<span class="sc">*</span>z1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">*</span>z2</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">main=</span><span class="fu">expression</span>(p1<span class="sc">==</span><span class="fl">0.25</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
We found that when p1 is around 0.5, the empirical distribution of the
mixture appears to be bimodal.</p>
<p>##Question3</p>
<p>A compound Poisson process is a stochastic process<span class="math inline">\(\left \{ X\left ( t \right ),t\ge 0  \right
\}\)</span> that can be represented as the random sum <span class="math display">\[X\left ( t \right )=\sum_{i=1}^{N\left ( t \right
)} Y_{i}  ,t\ge 0\]</span>, where <span class="math inline">\(\left \{
N\left ( t \right ),t\ge 0  \right \}\)</span> is a Poisson process and
<span class="math inline">\(Y_{1} ,Y_{2} ,...\)</span>are <span class="math inline">\(iid\)</span> and independent of <span class="math inline">\(\left \{ N\left ( t \right ),t\ge 0  \right
\}\)</span>.Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma process (Y has a Gamma
distribution). Estimate the mean and the variance of <span class="math inline">\(X\left ( 10 \right )\)</span> for several choices
of the parameters and compare with the theoretical values.Hint: Show
that <span class="math inline">\(E\left [ X\left ( t \right )  \right ]
=\lambda t E\left [  Y_{1}\right ]\)</span> and <span class="math inline">\(Var\left (  X\left ( t \right ) \right ) =\lambda
t E\left [  Y_{1}^{2}\right ]\)</span></p>
</div>
<div id="answer3" class="section level2">
<h2>Answer3</h2>
<p>First, we need to generate some random numbers for the Poisson
process.Then we generate the random numbers we need according to the
composite process of Poisson(λ)-Gamma.Finally, the mean and variance of
the obtained data are calculated and compared with the theoretical
values, the theoretical value can be obtained from <span class="math inline">\(E\left [ X\left ( t \right )  \right ] =\lambda t
E\left [  Y_{1}\right ]\)</span> and <span class="math inline">\(Var\left (  X\left ( t \right ) \right ) =\lambda
t E\left [  Y_{1}^{2}\right ]\)</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span>    </span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">2</span>     </span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">3</span>   </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="at">lambda =</span> lambda <span class="sc">*</span> t)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  </span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>{</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  <span class="cf">if</span> (N_t[i] <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  {X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rgamma</span>(N_t[i], <span class="at">shape =</span> alpha, <span class="at">rate =</span> gamma))}  </span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>   <span class="cf">else</span> </span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  { X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span> }</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)  </span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)    </span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> alpha <span class="sc">/</span> gamma</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> gamma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 均值: &quot;</span>, u,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的 X(10) 均值:  6.607285</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论 X(10) 均值: &quot;</span>, u1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论 X(10) 均值:  6.666667</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 方差: &quot;</span>, v, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的 X(10) 方差:  6.440669</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论 X(10) 方差: &quot;</span>, v1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论 X(10) 方差:  2.222222</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>    </span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span>     </span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">5</span>      </span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="at">lambda =</span> lambda <span class="sc">*</span> t)</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  </span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>{</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>  <span class="cf">if</span> (N_t[i] <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>  {X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rgamma</span>(N_t[i], <span class="at">shape =</span> alpha, <span class="at">rate =</span> gamma))}  </span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>   <span class="cf">else</span> </span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>  { X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span> }</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>}</span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)  </span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)    </span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> alpha <span class="sc">/</span> gamma</span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> gamma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 均值: &quot;</span>, u,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的 X(10) 均值:  12.01793</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论 X(10) 均值: &quot;</span>, u1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论 X(10) 均值:  12</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 方差: &quot;</span>, v, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的 X(10) 方差:  9.501813</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论 X(10) 方差: &quot;</span>, v1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论 X(10) 方差:  2.4</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">5</span>    </span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span>    </span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="dv">5</span>      </span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="at">lambda =</span> lambda <span class="sc">*</span> t)</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  </span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>{</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  <span class="cf">if</span> (N_t[i] <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  {X_t[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">rgamma</span>(N_t[i], <span class="at">shape =</span> alpha, <span class="at">rate =</span> gamma))}  </span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>   <span class="cf">else</span> </span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>  { X_t[i] <span class="ot">&lt;-</span> <span class="dv">0</span> }</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>}</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">mean</span>(X_t)  </span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">var</span>(X_t)    </span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> alpha <span class="sc">/</span> gamma</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> gamma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 均值: &quot;</span>, u,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的 X(10) 均值:  10.01729</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论 X(10) 均值: &quot;</span>, u1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论 X(10) 均值:  10</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;估计的 X(10) 方差: &quot;</span>, v, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 估计的 X(10) 方差:  4.049662</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;理论 X(10) 方差: &quot;</span>, v1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 理论 X(10) 方差:  2</code></pre>
</div>
</div>
<div id="section-2" class="section level1">
<h1>2024.09.23</h1>
<div id="question1-1" class="section level2">
<h2>Question1</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf,and use the function to estimate F(x) for x = 0.1, 0.2,…, 0.9.
Compare the estimates with the values returned by the pbeta function in
R.</p>
</div>
<div id="answer1-1" class="section level2">
<h2>Answer1</h2>
<p>Firstly, we know that the distribution density function of Beta (3,3)
is <span class="math inline">\(f\left ( x \right ) : 30x^{2} \left
(  1-x\right ) ^{2}\)</span>,so its cumulative distribution function
<span class="math inline">\(F(x)\)</span> is <span class="math display">\[
\int_{0}^{x}30t^{2} \left (  1-t\right ) ^{2} dt = xE\left [30T^{2}
\left (  1-T\right ) ^{2} \right ],T\in U\left ( 0,x \right )  .
\]</span> Then we can use simple Monte Carlo estimator.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a> m <span class="ot">&lt;-</span> <span class="fl">1e4</span>; x<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a> t <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>x)</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a> theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">30</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>t)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> x</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a> <span class="fu">round</span>(theta.hat,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.08150 0.16300 0.24451 0.32601 0.40751 0.48901 0.57051 0.65201 0.73352</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">pbeta</span>(x, <span class="at">shape1=</span><span class="dv">3</span>, <span class="at">shape2=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.00856 0.05792 0.16308 0.31744 0.50000 0.68256 0.83692 0.94208 0.99144</code></pre>
</div>
<div id="question2-1" class="section level2">
<h2>Question2</h2>
<p>The Rayleigh density [156, (18.76)] is <span class="math display">\[
f(x)=\frac{x}{\sigma^2} e^{-x^2/(2\sigma^2)},\quad x\geq0, \sigma&gt;0.
\]</span> Implement a function to generate samples from a Rayleigh(σ)
distribution,using antithetic variables. What is the percent reduction
in variance of <span class="math inline">\(\frac{X+X^{\prime}}2\)</span>
compared with <span class="math inline">\(\frac{X_{1}+X_{2}}2\)</span>for independent <span class="math inline">\(X_{1},X_{2}\)</span>?</p>
</div>
<div id="answer2-1" class="section level2">
<h2>Answer2</h2>
<p>The problem is to estimate <span class="math display">\[
F\left ( x \right ) =\int_{0}^{x} \frac{t}{\sigma^2}
e^{-t^2/(2\sigma^2)}dt
\]</span> The simple estimator is <span class="math display">\[
\hat{\theta}=\frac{1}{m}\sum_{j=1}^{m} x\frac{U_{j} }{\sigma^2}
e^{-U_{j} ^2/(2\sigma^2)} ,U_{j}\sim U\left ( 0,x \right )
\]</span> The antithetic variable estimator is <span class="math display">\[
\hat{\theta}^{&#39;} =\frac{1}{m}\sum_{j=1}^{m/2}\left (   x\frac{U_{j}
}{\sigma^2} e^{-U_{j} ^2/(2\sigma^2)}+x\frac{\left (   x-U_{j}\right )
}{\sigma^2} e^{-\left (   x-U_{j}\right ) ^2/(2\sigma^2)}\right
)   ,U_{j}\sim U\left ( 0,x \right )
\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) </span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>  {</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n) </span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> a <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u)) </span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  }</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) </span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  {</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> a <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u)) </span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  xp <span class="ot">&lt;-</span> a <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u)) </span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x, xp))</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  }</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) {</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">f</span>(n, a)</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">f</span>(n, a)</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">g</span>(n, a)</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  mean1 <span class="ot">&lt;-</span> (x1 <span class="sc">+</span> x2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  mean2 <span class="ot">&lt;-</span> (x3[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)] <span class="sc">+</span> x3[(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  percent_reduction <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">*</span> (<span class="fu">var</span>(mean1) <span class="sc">-</span> <span class="fu">var</span>(mean2)) <span class="sc">/</span> <span class="fu">var</span>(mean1)</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>}</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a> <span class="fu">print</span>(<span class="fu">sd1</span>(<span class="dv">10000</span>,<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 94.73307</code></pre>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞)
and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}} e^{-x^2/2},\quad
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}
dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer3-1" class="section level2">
<h2>Answer3</h2>
<p>We can use <span class="math inline">\(f_{1}(x)=e^{1-x}\)</span> and
<span class="math inline">\(f_{2}(x)=\frac{1}{x^2}\)</span> as
importance functions.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e4</span>;</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>est <span class="ot">&lt;-</span> sd <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) </span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>  {</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  }</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>f1g <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(f1g)</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(f1g)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>f2g <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(f2g)</span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(f2g)</span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(u1,u2,sd1,sd2))</span></code></pre></div>
<pre><code>## [1] 0.06867528 0.19650593 0.16275856 0.29964034</code></pre>
<p>From the data point of view, the result obtained by f1 function is
better.</p>
</div>
<div id="question4" class="section level2">
<h2>Question4</h2>
<p>Monte Carlo experiment.For <span class="math inline">\(n = 10^{4}, 2
×10^{4}, 4 × 10^{4}, 6 × 10^{4}, 8 × 10^{4}\)</span>, apply the
fastsorting algorithm to randomly permuted numbers of 1, . . . ,
n.Calculate computation time averaged over 100 simulations,denoted by
an.Regress an on tn := n log(n), and graphically show the
results(scatter plot and regression line).</p>
</div>
<div id="answer4" class="section level2">
<h2>Answer4</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>  {</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>      <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>        }<span class="cf">else</span>{</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>          t<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>          y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>          lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>t]</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>          upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>t]</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>          <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),t,<span class="fu">quick_sort</span>(upper)))</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>        }</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>}</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">100</span>;y<span class="ot">&lt;-</span><span class="fu">numeric</span>(m);average<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n[k])</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>    y[j]<span class="ot">&lt;-</span><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(a))[<span class="dv">1</span>]</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>  }</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>  average[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(y)</span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>} </span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>average</span></code></pre></div>
<pre><code>## [1] 0.0132 0.0271 0.0577 0.0824 0.1114</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>z<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">lm</span>(average<span class="sc">~</span>z)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = average ~ z)
## 
## Coefficients:
## (Intercept)            z  
##   3.550e-03    1.203e-07</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">plot</span>(z,average)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">lines</span>(z,average)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-3" class="section level1">
<h1>2024.09.30</h1>
<div id="qusetion1" class="section level2">
<h2>Qusetion1</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation<span class="math inline">\(\sqrt{b_1}\approx N(0,\frac{6}{n}).\)</span></p>
</div>
<div id="answer1-2" class="section level2">
<h2>Answer1</h2>
<p>In fact, I haven’t fully mastered this part of the content, so I made
some requests for network information, and the code may not be
perfect.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>skewness_values <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b){</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>   sqrt.b1<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>   c<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(b))</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">mean</span>(a[i,])</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">sd</span>(a[i,])</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>    sqrt.b1[i] <span class="ot">&lt;-</span> <span class="cf">if</span>((<span class="fu">mean</span>((a[i,] <span class="sc">-</span> x)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> y<span class="sc">^</span><span class="dv">3</span>) <span class="sc">&gt;=</span> <span class="dv">0</span>){</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>    <span class="fu">sqrt</span>((<span class="fu">mean</span>((a[i,] <span class="sc">-</span> x)<span class="sc">^</span><span class="dv">3</span>) <span class="sc">/</span> y<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a>      sqrt.b1[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>    }</span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>   }</span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>   sqrt.b1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(sqrt.b1)</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>   c <span class="ot">&lt;-</span> <span class="fu">quantile</span>(sqrt.b1, <span class="at">probs =</span> b)</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a>   <span class="fu">print</span>(b)</span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>   <span class="fu">print</span>(c)</span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a>}</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a></span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>normal_b<span class="ot">&lt;-</span> <span class="cf">function</span>(n,b){</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">qnorm</span>(b, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>m))</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  <span class="fu">print</span>(t)</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>}</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="cf">function</span>(b,x_values,m) {</span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a>    se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>b)) <span class="sc">/</span> (m <span class="sc">*</span> x_values<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a>    <span class="fu">print</span>(se)</span>
<span id="cb65-27"><a href="#cb65-27" tabindex="-1"></a>}</span>
<span id="cb65-28"><a href="#cb65-28" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb65-29"><a href="#cb65-29" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb65-30"><a href="#cb65-30" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb65-31"><a href="#cb65-31" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(b)</span>
<span id="cb65-32"><a href="#cb65-32" tabindex="-1"></a></span>
<span id="cb65-33"><a href="#cb65-33" tabindex="-1"></a>a<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(m <span class="sc">*</span> n), <span class="at">nrow =</span> m, <span class="at">ncol =</span> n)</span>
<span id="cb65-34"><a href="#cb65-34" tabindex="-1"></a></span>
<span id="cb65-35"><a href="#cb65-35" tabindex="-1"></a><span class="fu">skewness_values</span>(a,b)</span></code></pre></div>
<pre><code>## [1] 0.025 0.050 0.950 0.975
##       2.5%         5%        95%      97.5% 
## 0.04861529 0.06718126 0.39124838 0.41464766</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">normal_b</span>(n,b)</span></code></pre></div>
<pre><code>## [1] -0.04800912 -0.04029052  0.04029052  0.04800912</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">standard_errors</span>(b,x_values,m)</span></code></pre></div>
<pre><code>## [1] 0.0007965705 0.0013250112 0.0013250112 0.0007965705</code></pre>
</div>
<div id="question2-2" class="section level2">
<h2>Question2</h2>
<p>Tests for association based on Pearson product moment correlation ρ,
Spearman’s rank correlation coefficient ρs, or Kendall’s coefficient τ,
are implemented in cor.test. Show (empirically) that the nonparametric
tests based on ρs or τ are less powerful than the correlation test when
the sampled distribution is bivariate normal. Find an example of an
alternative (a bivariate distribution (X, Y ) such that X and Y are
dependent) such that at least one of the nonparametric tests have better
empirical power than the correlation test against this alternative.</p>
</div>
<div id="answer2-2" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span> </span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">1</span>) </span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)  </span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>pearson_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>pearson_p_value <span class="ot">&lt;-</span> pearson_res<span class="sc">$</span>p.value</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>spearman_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>spearman_p_value <span class="ot">&lt;-</span> spearman_res<span class="sc">$</span>p.value</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a></span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>kendall_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>kendall_p_value <span class="ot">&lt;-</span> kendall_res<span class="sc">$</span>p.value</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Pearson相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Pearson相关性检验:</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数:&quot;</span>, pearson_res<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数: 0.003380361</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, pearson_p_value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.914977</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman相关性检验:</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数:&quot;</span>, spearman_res<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数: 0.009139545</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, spearman_p_value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.7728012</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kendall相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kendall相关性检验:</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数:&quot;</span>, kendall_res<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数: 0.005805806</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, kendall_p_value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.7833835</code></pre>
<p>We find that nonparametric test based on ρs or τ is not as effective
as correlation test when both samples are normally distributed.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span> </span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>y <span class="ot">&lt;-</span><span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>) </span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>pearson_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>pearson_p_value <span class="ot">&lt;-</span> pearson_res<span class="sc">$</span>p.value</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>spearman_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>spearman_p_value <span class="ot">&lt;-</span> spearman_res<span class="sc">$</span>p.value</span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>kendall_res <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>kendall_p_value <span class="ot">&lt;-</span> kendall_res<span class="sc">$</span>p.value</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a></span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Pearson相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Pearson相关性检验:</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数:&quot;</span>, pearson_res<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数: -0.04556105</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, pearson_p_value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.1499487</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Spearman相关性检验:</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数:&quot;</span>, spearman_res<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数: -0.04238537</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, spearman_p_value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.1804518</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Kendall相关性检验:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Kendall相关性检验:</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;相关系数:&quot;</span>, kendall_res<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 相关系数: -0.02735936</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p值:&quot;</span>, kendall_p_value, <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## p值: 0.1951475</code></pre>
<p>However, if one sample is uniformly distributed and the other is
still normally distributed, nonparametric test will have better
empirical efficacy than correlation test.</p>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level. 1.What is the corresponding hypothesis test problem? What test
should we use? 2.Z-test, two-sample t-test,paired-t test or McNemar
test? Why? 3.Please provide the least necessary information for hypothes
is testing.</p>
<p>##Answer3 1.H0:power1=power2 v.s H1:power1≠power2</p>
<p>2.because of the paired date,we can not use it;we can use paired-t
test or McNemar test.But we can not use Z-test,because we do not know
real variance.</p>
<p>3.we should knowthe powers of two different methods and the mean and
variance of their difference.</p>
</div>
</div>
<div id="section-4" class="section level1">
<h1>2024.10.14</h1>
<div id="question1-2" class="section level2">
<h2>Question1</h2>
<p>Of N = 1000 hypotheses, 950 are null and 50 are alternative.The
p-value under any null hypothesis is uniformly distributed (use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level <span class="math inline">\(\alpha =
0.1\)</span> for each of the two adjustment methods based on m = 10000
simulation replicates. You should output the 6 numbers (3 ) to a 3 × 2
table (column names: Bonferroni correction, B-H correction; row names:
FWER, FDR, TPR).Comment the results.</p>
</div>
<div id="answer1-3" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>m0<span class="ot">&lt;-</span><span class="dv">950</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>FWER <span class="ot">&lt;-</span> <span class="cf">function</span>(R, FP) {</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>  <span class="fu">mean</span>(FP <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>  }</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>FDR <span class="ot">&lt;-</span> <span class="cf">function</span>(R, FP) {</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  <span class="cf">if</span> (R <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  <span class="fu">mean</span>(FP <span class="sc">/</span> R)</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>}</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a>TPR <span class="ot">&lt;-</span> <span class="cf">function</span>(R, TP) {</span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a>  <span class="cf">if</span> (R <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb107-15"><a href="#cb107-15" tabindex="-1"></a>  <span class="fu">mean</span>(TP <span class="sc">/</span> (N<span class="sc">-</span>m0)) </span>
<span id="cb107-16"><a href="#cb107-16" tabindex="-1"></a>}</span>
<span id="cb107-17"><a href="#cb107-17" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">nrow =</span> m,<span class="at">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb107-18"><a href="#cb107-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb107-19"><a href="#cb107-19" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">runif</span>(m0), <span class="fu">rbeta</span>(N<span class="sc">-</span>m0, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb107-20"><a href="#cb107-20" tabindex="-1"></a>p.adj_bonferroni<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb107-21"><a href="#cb107-21" tabindex="-1"></a>p.adj_fdr<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&#39;fdr&#39;</span>)</span>
<span id="cb107-22"><a href="#cb107-22" tabindex="-1"></a>bonferroni_R <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_bonferroni <span class="sc">&lt;</span> alpha)</span>
<span id="cb107-23"><a href="#cb107-23" tabindex="-1"></a>bonferroni_FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_bonferroni[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb107-24"><a href="#cb107-24" tabindex="-1"></a>bonferroni_TP <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_bonferroni[<span class="dv">951</span><span class="sc">:</span>N] <span class="sc">&lt;</span> alpha)</span>
<span id="cb107-25"><a href="#cb107-25" tabindex="-1"></a>fdr_R <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_fdr <span class="sc">&lt;</span> alpha)</span>
<span id="cb107-26"><a href="#cb107-26" tabindex="-1"></a>fdr_FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_fdr[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>] <span class="sc">&lt;</span> alpha)</span>
<span id="cb107-27"><a href="#cb107-27" tabindex="-1"></a>fdr_TP <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_fdr[<span class="dv">951</span><span class="sc">:</span>N] <span class="sc">&lt;</span> alpha)</span>
<span id="cb107-28"><a href="#cb107-28" tabindex="-1"></a>y[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">FWER</span>(bonferroni_R,bonferroni_FP)</span>
<span id="cb107-29"><a href="#cb107-29" tabindex="-1"></a>y[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">FDR</span>(bonferroni_R,bonferroni_FP)</span>
<span id="cb107-30"><a href="#cb107-30" tabindex="-1"></a>y[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">TPR</span>(bonferroni_R,bonferroni_TP)</span>
<span id="cb107-31"><a href="#cb107-31" tabindex="-1"></a>y[i,<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">FWER</span>(fdr_R,fdr_FP)</span>
<span id="cb107-32"><a href="#cb107-32" tabindex="-1"></a>y[i,<span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fu">FDR</span>(fdr_R,fdr_FP)</span>
<span id="cb107-33"><a href="#cb107-33" tabindex="-1"></a>y[i,<span class="dv">6</span>]<span class="ot">&lt;-</span><span class="fu">TPR</span>(fdr_R,fdr_TP)</span>
<span id="cb107-34"><a href="#cb107-34" tabindex="-1"></a>}</span>
<span id="cb107-35"><a href="#cb107-35" tabindex="-1"></a>bonferroni_FWER<span class="ot">&lt;-</span><span class="fu">mean</span>(y[,<span class="dv">1</span>])</span>
<span id="cb107-36"><a href="#cb107-36" tabindex="-1"></a>bonferroni_FDR<span class="ot">&lt;-</span><span class="fu">mean</span>(y[,<span class="dv">2</span>])</span>
<span id="cb107-37"><a href="#cb107-37" tabindex="-1"></a>bonferroni_TPR<span class="ot">&lt;-</span><span class="fu">mean</span>(y[,<span class="dv">3</span>])</span>
<span id="cb107-38"><a href="#cb107-38" tabindex="-1"></a>fdr_FWER<span class="ot">&lt;-</span><span class="fu">mean</span>(y[,<span class="dv">4</span>])</span>
<span id="cb107-39"><a href="#cb107-39" tabindex="-1"></a>fdr_FDR<span class="ot">&lt;-</span><span class="fu">mean</span>(y[,<span class="dv">5</span>])</span>
<span id="cb107-40"><a href="#cb107-40" tabindex="-1"></a>fdr_TPR<span class="ot">&lt;-</span><span class="fu">mean</span>(y[,<span class="dv">6</span>])</span>
<span id="cb107-41"><a href="#cb107-41" tabindex="-1"></a>output_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb107-42"><a href="#cb107-42" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>),</span>
<span id="cb107-43"><a href="#cb107-43" tabindex="-1"></a>  <span class="at">Bonferroni =</span> <span class="fu">c</span>(bonferroni_FWER, bonferroni_FDR,bonferroni_TPR),</span>
<span id="cb107-44"><a href="#cb107-44" tabindex="-1"></a>  <span class="at">BH =</span> <span class="fu">c</span>(fdr_FWER, fdr_TPR, fdr_TPR)</span>
<span id="cb107-45"><a href="#cb107-45" tabindex="-1"></a>)</span>
<span id="cb107-46"><a href="#cb107-46" tabindex="-1"></a></span>
<span id="cb107-47"><a href="#cb107-47" tabindex="-1"></a><span class="fu">print</span>(output_table)</span></code></pre></div>
<pre><code>##   Metric  Bonferroni       BH
## 1   FWER 0.091200000 0.931000
## 2    FDR 0.004705812 0.562732
## 3    TPR 0.397816000 0.562732</code></pre>
<p>In fact, I got a very strange result. There are great differences
between Bonferroni method and B-H theory in FWER, FDR and TPR. Only TPR
got similar results. Moreover, the results obtained by Bonferroni
adjustment are less than those obtained by B-H adjustment.</p>
</div>
<div id="question2-3" class="section level2">
<h2>Question2</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
airconditioning equipment [63, Example 1.1]: 3, 5, 7, 18, 43, 85, 91,
98, 100, 130, 230, 487. Assume that the times between failures follow an
exponential model Exp(λ).Obtain the MLE of the hazard rate λ and use
bootstrap to estimate the bias and standard error of the estimate</p>
</div>
<div id="answer2-3" class="section level2">
<h2>Answer2</h2>
<p>The title has explained that the sample is obtained from the
exponential distribution exp (λ), so we can use the parameterized
bootstrap method.First of all, we know the MLE of λ is <span class="math inline">\(\frac{1}{\overline{x}}\)</span>.Then, we can
estimate the bias and standard error of the estimate by parametric
bootstrap method.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a><span class="co">#定义参数分布</span></span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>gen_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x,mle) {</span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="fu">length</span>(x),mle)</span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>    <span class="fu">return</span>(data)}</span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a><span class="co">#定义计算统计量的函数</span></span>
<span id="cb109-8"><a href="#cb109-8" tabindex="-1"></a>theta_star_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i])</span>
<span id="cb109-9"><a href="#cb109-9" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span>x, <span class="at">sim =</span> <span class="st">&quot;parametric&quot;</span>, <span class="at">ran.gen =</span>  gen_function, <span class="at">mle =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x), <span class="at">statistic =</span> theta_star_function, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb109-10"><a href="#cb109-10" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>B<span class="sc">$</span>t0,<span class="at">bias=</span><span class="fu">mean</span>(B<span class="sc">$</span>t)<span class="sc">-</span>B<span class="sc">$</span>t0,<span class="at">se=</span><span class="fu">sd</span>(B<span class="sc">$</span>t)),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##  0.00925  0.00079  0.00310</code></pre>
</div>
<div id="question3-2" class="section level2">
<h2>Question3</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer3-2" class="section level2">
<h2>Answer3</h2>
<p>Let <span class="math inline">\(\hat\theta=1/\hat\lambda=\overline
x\)</span>.We need to compute 95% bootstrap confidence intervals for the
mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods.So we must go back to parametric bootstrap
method.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>mle <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a><span class="co">#定义统计量计算的函数</span></span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>theta_star_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a><span class="co">#执行自助法</span></span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> theta_star_function, <span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a><span class="co">#计算置信区间</span></span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>ci_norm <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(B, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(B, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a>ci_perc <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(B, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(B, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Standard Normal Method CI:</span><span class="sc">\n</span><span class="st">&quot;</span>, ci_norm<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;Basic Method CI:</span><span class="sc">\n</span><span class="st">&quot;</span>, ci_basic<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a><span class="st">&quot;Percentile Method CI:</span><span class="sc">\n</span><span class="st">&quot;</span>, ci_perc<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;BCa Method CI:</span><span class="sc">\n</span><span class="st">&quot;</span>, ci_bca<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Standard Normal Method CI:
##  37.89861 182.5276 
##  Basic Method CI:
##  32.6836 168.2415 
##  Percentile Method CI:
##  47.92514 183.4831 
##  BCa Method CI:
##  57.36206 217.5713</code></pre>
<p>Observing the results, we see that they all contain truth values
<span class="math inline">\(\overline x=108\)</span>. Then calculate
their interval length.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>ci_norm_lenth<span class="ot">=</span>ci_norm<span class="sc">$</span>normal[<span class="dv">3</span>]<span class="sc">-</span>ci_norm<span class="sc">$</span>normal[<span class="dv">2</span>]</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>ci_basic_lenth<span class="ot">=</span>ci_basic<span class="sc">$</span>basic[<span class="dv">5</span>]<span class="sc">-</span>ci_basic<span class="sc">$</span>basic[<span class="dv">4</span>]</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>ci_perc_lenth<span class="ot">=</span>ci_perc<span class="sc">$</span>percent[<span class="dv">5</span>]<span class="sc">-</span>ci_perc<span class="sc">$</span>percent[<span class="dv">4</span>]</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>ci_bca_lenth<span class="ot">=</span>ci_bca<span class="sc">$</span>bca[<span class="dv">5</span>]<span class="sc">-</span>ci_bca<span class="sc">$</span>bca[<span class="dv">4</span>]</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a><span class="fu">cat</span>(ci_norm_lenth,ci_basic_lenth,ci_perc_lenth,ci_bca_lenth)</span></code></pre></div>
<pre><code>## 144.629 135.5579 135.5579 160.2093</code></pre>
<p>We see that percentile, and BCa methods get the best results.
Finally, we repeated the experiment for many times to compare the
correct rate of confidence intervals obtained by standard normal, basic,
Percentile and BCA methods containing true values.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>mle <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> x, <span class="at">statistic =</span> theta_star_function, <span class="at">R=</span><span class="dv">1000</span>)<span class="co">#执行自助法</span></span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(B,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb115-10"><a href="#cb115-10" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb115-11"><a href="#cb115-11" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb115-12"><a href="#cb115-12" tabindex="-1"></a>}</span>
<span id="cb115-13"><a href="#cb115-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mle <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mle),</span>
<span id="cb115-14"><a href="#cb115-14" tabindex="-1"></a>    <span class="st">&#39;basic =&#39;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mle <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mle),</span>
<span id="cb115-15"><a href="#cb115-15" tabindex="-1"></a>    <span class="st">&#39;perc =&#39;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mle <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mle),</span>
<span id="cb115-16"><a href="#cb115-16" tabindex="-1"></a>    <span class="st">&#39;BCa =&#39;</span>,<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mle <span class="sc">&amp;</span> ci.bca[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mle))</span></code></pre></div>
<pre><code>## norm = 1 basic = 1 perc = 1 BCa = 1</code></pre>
<p>We find that their correct rate is 1, and there is no error at all.
This is not a good estimation result, it may be improved by other
methods.</p>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2024.10.21</h1>
<div id="question1-3" class="section level2">
<h2>Question1</h2>
<p>7.8 Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\widehat{\theta
}\)</span>.</p>
</div>
<div id="answer1-4" class="section level2">
<h2>Answer1</h2>
<p>First, we find the function theta of sample estimation
parameters.Then, the estimated value <span class="math inline">\(\widehat{\theta }\)</span>is calculated by using
the sample data.Finally, the knife cutting method is used to calculate
bias and standard error of <span class="math inline">\(\widehat{\theta
}\)</span>.</p>
<p>Results and code implementation are as follows.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i){</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a>  val<span class="ot">=</span><span class="fu">eigen</span>(<span class="fu">cov</span>(x[i,]))<span class="sc">$</span>values</span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a>  <span class="fu">return</span>(val[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(val))</span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a>}</span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">theta</span>(scor,<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">theta</span>(scor,(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i])</span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a>}</span>
<span id="cb117-12"><a href="#cb117-12" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb117-13"><a href="#cb117-13" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb117-14"><a href="#cb117-14" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">thetahat=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,</span>
<span id="cb117-15"><a href="#cb117-15" tabindex="-1"></a><span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  thetahat bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="question2-4" class="section level2">
<h2>Question2</h2>
<p>7.10 In Example 7.18, leave-one-out (n-fold) cross validation was
used to select the best fitting model. Repeat the analysis replacing the
Log-Log model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</div>
<div id="answer2-4" class="section level2">
<h2>Answer2</h2>
<p>Firstly, we calculate the residuals of the four models.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">library</span>(DAAG);<span class="fu">attach</span>(ironslag)</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span>e2 <span class="ot">&lt;-</span>e3 <span class="ot">&lt;-</span>e4 <span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>  </span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span>magnetic[k] <span class="sc">-</span>yhat1</span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  </span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span>magnetic[k] <span class="sc">-</span>yhat2</span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>  </span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y)<span class="sc">~</span>x)</span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span><span class="fu">exp</span>(logyhat3)</span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span>magnetic[k] <span class="sc">-</span>yhat3</span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a>  </span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb119-22"><a href="#cb119-22" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb119-23"><a href="#cb119-23" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span>magnetic[k] <span class="sc">-</span>yhat4</span>
<span id="cb119-24"><a href="#cb119-24" tabindex="-1"></a>}</span>
<span id="cb119-25"><a href="#cb119-25" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>According to the residuals,we can see Model 2 would be the best fit
for the data.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>J2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.98525     -1.52948      0.05707</code></pre>
<p>The fitted regression equation for model 2 is <span class="math display">\[\hat{Y} =24.493-1.393X+0.055X^{2}\]</span> Then
we can study maximum adjusted <span class="math inline">\(R^{2}\)</span>
of the four models.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>r1<span class="ot">=</span><span class="fu">summary</span>(J1)<span class="sc">$</span>adj.r.squared</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>r2<span class="ot">=</span><span class="fu">summary</span>(J2)<span class="sc">$</span>adj.r.squared</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>r3<span class="ot">=</span><span class="fu">summary</span>(J3)<span class="sc">$</span>adj.r.squared</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>r4<span class="ot">=</span><span class="fu">summary</span>(J4)<span class="sc">$</span>adj.r.squared</span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a><span class="fu">c</span>(r1,r2,r3,r4)</span></code></pre></div>
<pre><code>## [1] 0.5319104 0.5909726 0.5283260 0.5937184</code></pre>
<p>According to the maximum adjusted <span class="math inline">\(R^{2}\)</span>,we can see Model 4 would be the
best fit for the data.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>J4</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Coefficients:
## (Intercept)            x       I(x^2)       I(x^3)  
##   -2.763718     2.908468    -0.160916     0.003424</code></pre>
<p>The fitted regression equation for model 4 is <span class="math display">\[ \hat{Y} =2.764+2.908X-0.161X^{2}+0.003X^{3}
\]</span></p>
</div>
<div id="question3-3" class="section level2">
<h2>Question3</h2>
<p>8.1 Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer3-3" class="section level2">
<h2>Answer3</h2>
<p>Similar to the expression in Example 8.2, we only need to construct
the function cm.test to calculate new integrated squared distance
between the distributions.</p>
<p>Results and code implementation are as follows.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)</span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span></span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb127-10"><a href="#cb127-10" tabindex="-1"></a>cm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb127-11"><a href="#cb127-11" tabindex="-1"></a>    Fn<span class="ot">=</span><span class="fu">ecdf</span>(x)</span>
<span id="cb127-12"><a href="#cb127-12" tabindex="-1"></a>    Gm<span class="ot">=</span><span class="fu">ecdf</span>(y)</span>
<span id="cb127-13"><a href="#cb127-13" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb127-14"><a href="#cb127-14" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb127-15"><a href="#cb127-15" tabindex="-1"></a>    a <span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb127-16"><a href="#cb127-16" tabindex="-1"></a>    b <span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb127-17"><a href="#cb127-17" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb127-18"><a href="#cb127-18" tabindex="-1"></a>        a[i]<span class="ot">=</span>(<span class="fu">Fn</span>(x[i])<span class="sc">-</span><span class="fu">Gm</span>(x[i]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb127-19"><a href="#cb127-19" tabindex="-1"></a>    }</span>
<span id="cb127-20"><a href="#cb127-20" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb127-21"><a href="#cb127-21" tabindex="-1"></a>        b[i]<span class="ot">=</span>(<span class="fu">Fn</span>(y[i])<span class="sc">-</span><span class="fu">Gm</span>(y[i]))<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb127-22"><a href="#cb127-22" tabindex="-1"></a>    }</span>
<span id="cb127-23"><a href="#cb127-23" tabindex="-1"></a>    s<span class="ot">=</span><span class="fu">sum</span>(a)<span class="sc">+</span><span class="fu">sum</span>(b)</span>
<span id="cb127-24"><a href="#cb127-24" tabindex="-1"></a>    W2<span class="ot">=</span>s<span class="sc">*</span>m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb127-25"><a href="#cb127-25" tabindex="-1"></a>    <span class="fu">return</span>(W2)</span>
<span id="cb127-26"><a href="#cb127-26" tabindex="-1"></a>}</span>
<span id="cb127-27"><a href="#cb127-27" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">cm.test</span>(x,y)</span>
<span id="cb127-28"><a href="#cb127-28" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb127-29"><a href="#cb127-29" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>,<span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-30"><a href="#cb127-30" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb127-31"><a href="#cb127-31" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb127-32"><a href="#cb127-32" tabindex="-1"></a>    D[i] <span class="ot">&lt;-</span> <span class="fu">cm.test</span>(x1, y1)</span>
<span id="cb127-33"><a href="#cb127-33" tabindex="-1"></a>}</span>
<span id="cb127-34"><a href="#cb127-34" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(D0, D)<span class="sc">&gt;=</span> D0)</span>
<span id="cb127-35"><a href="#cb127-35" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.411</code></pre>
<p>The approximate p-value 0.411 does not support the alternative
hypothesis that distributions differ.</p>
</div>
<div id="question4-1" class="section level2">
<h2>Question4</h2>
<p>8.2 Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer4-1" class="section level2">
<h2>Answer4</h2>
<p>With the function cor with method = “spearman”, we can easily get the
Spearman rank correlation test statistic.Then use the permutation test
on it. Then we can get the achieved significance level of the
permutation test.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicate</span></span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x,y)<span class="co">#pooled sample</span></span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">+</span>n)</span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)<span class="co"># storage for replicate</span></span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a>cor0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb129-14"><a href="#cb129-14" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span> <span class="fu">cor</span>(x1,y1,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb129-15"><a href="#cb129-15" tabindex="-1"></a>}</span>
<span id="cb129-16"><a href="#cb129-16" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(cor0,reps)<span class="sc">&gt;=</span>cor0)</span>
<span id="cb129-17"><a href="#cb129-17" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.474</code></pre>
<p>On the same sample, we can get the p-value reported by cor.test</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">cor.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = -0.49095, df = 98, p-value = 0.6246
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.2435805  0.1483291
## sample estimates:
##         cor 
## -0.04953215</code></pre>
<p>Compared with the two,we found that the P values of the two are
similar, notbut close enough.</p>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2024.10.28</h1>
<div id="question1-4" class="section level2">
<h2>Question1</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchy or qt with df=1). Recall
that a Cauchy(θ, η) distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad-\infty&lt;x&lt;\infty,
\theta&gt;0.\]</span> The standard Cauchy has the Cauchy(θ = 1, η = 0)
density. (Note that the standard Cauchy density is equal to the Student
t density with one degree of freedom.)</p>
</div>
<div id="answer1-5" class="section level2">
<h2>Answer1</h2>
<p>In order to generate random variables from the standard Cauchy
distribution using the Metropolis-Hastings sampler, I take the student t
distribution as the proposed function, and each <span class="math inline">\(X_{n}\)</span> will be generated from the t
distribution with the absolute value of <span class="math inline">\(X_{n}\)</span>. The process and the results
obtained are as follows.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;coda&quot;</span>)</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>}</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>M_H <span class="ot">&lt;-</span> <span class="cf">function</span>(N, initial_value) {</span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rt</span>(<span class="dv">1</span>, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span><span class="fu">rt</span>(<span class="dv">1</span>, <span class="at">df =</span> <span class="fu">abs</span>(x[i <span class="sc">-</span> <span class="dv">1</span>]))</span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="fu">f</span>(proposal) <span class="sc">*</span><span class="fu">dt</span>(proposal,<span class="fu">abs</span>(x[i <span class="sc">-</span> <span class="dv">1</span>]))<span class="sc">/</span> <span class="fu">f</span>(x[i <span class="sc">-</span> <span class="dv">1</span>])<span class="sc">*</span><span class="fu">dt</span>(x[i <span class="sc">-</span> <span class="dv">1</span>],<span class="fu">abs</span>(proposal))</span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb133-12"><a href="#cb133-12" tabindex="-1"></a>    <span class="cf">if</span> (u<span class="sc">&lt;</span>alpha) {</span>
<span id="cb133-13"><a href="#cb133-13" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb133-14"><a href="#cb133-14" tabindex="-1"></a>    } </span>
<span id="cb133-15"><a href="#cb133-15" tabindex="-1"></a>       <span class="cf">else</span> {</span>
<span id="cb133-16"><a href="#cb133-16" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb133-17"><a href="#cb133-17" tabindex="-1"></a>    }</span>
<span id="cb133-18"><a href="#cb133-18" tabindex="-1"></a>  }</span>
<span id="cb133-19"><a href="#cb133-19" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb133-20"><a href="#cb133-20" tabindex="-1"></a>}</span>
<span id="cb133-21"><a href="#cb133-21" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb133-22"><a href="#cb133-22" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb133-23"><a href="#cb133-23" tabindex="-1"></a>initial_value <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb133-24"><a href="#cb133-24" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">M_H</span>(N, initial_value)</span>
<span id="cb133-25"><a href="#cb133-25" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N<span class="dv">-1000</span>)</span>
<span id="cb133-26"><a href="#cb133-26" tabindex="-1"></a>x<span class="ot">&lt;-</span>y[<span class="dv">1001</span><span class="sc">:</span><span class="dv">10000</span>]</span>
<span id="cb133-27"><a href="#cb133-27" tabindex="-1"></a>a1<span class="ot">&lt;-</span>a2 <span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb133-28"><a href="#cb133-28" tabindex="-1"></a>a1<span class="ot">&lt;-</span><span class="fu">quantile</span>(x,<span class="at">probs=</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="at">by=</span><span class="fl">0.1</span>))</span>
<span id="cb133-29"><a href="#cb133-29" tabindex="-1"></a>a2<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="at">by=</span><span class="fl">0.1</span>),<span class="dv">1</span>)</span>
<span id="cb133-30"><a href="#cb133-30" tabindex="-1"></a>decile_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb133-31"><a href="#cb133-31" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">1.0</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb133-32"><a href="#cb133-32" tabindex="-1"></a>  <span class="at">Observation_Deciles =</span> a1,</span>
<span id="cb133-33"><a href="#cb133-33" tabindex="-1"></a>  <span class="at">Theoretical_Deciles =</span> a2</span>
<span id="cb133-34"><a href="#cb133-34" tabindex="-1"></a>)</span>
<span id="cb133-35"><a href="#cb133-35" tabindex="-1"></a><span class="fu">print</span>(decile_comparison)</span></code></pre></div>
<pre><code>##      Decile Observation_Deciles Theoretical_Deciles
## 10%     0.1          -0.4126212          -3.0776835
## 20%     0.2          -0.2711596          -1.3763819
## 30%     0.3          -0.2202780          -0.7265425
## 40%     0.4          -0.0288232          -0.3249197
## 50%     0.5           0.1227424           0.0000000
## 60%     0.6           0.1991403           0.3249197
## 70%     0.7           0.2735653           0.7265425
## 80%     0.8           0.4652576           1.3763819
## 90%     0.9           0.6114047           3.0776835
## 100%    1.0           1.8454135                 Inf</code></pre>
<p>We compare the decimals of the generated observations with those of
the standard Cauchy distribution, unfortunately, the obtained values are
not very close. I guess this is because the degree of freedom of the
proposed function I use takes advantage of the absolute value and
weakens the good properties of the theory.</p>
</div>
<div id="question2-5" class="section level2">
<h2>Question2</h2>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto\binom
nxy^{x+a-1}(1-y)^{n-x+b-1},\quad x=0,1,\ldots,n, 0\leq y\leq1.\]</span>.
It can be shown (see e.g. [23]) that for fixed a, b, n, the conditional
distributions are <span class="math inline">\(\mathrm{Binomial}(n,y)\)</span> and <span class="math inline">\(\mathrm{Beta}(x+a,n-x+b)\)</span>. Use the Gibbs
sampler to generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
</div>
<div id="answer2-5" class="section level2">
<h2>Answer2</h2>
<p>Use the Gibbs sampler,we can easily generate a chain.The process and
the results obtained are as follows.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span>  </span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a>  </span>
<span id="cb135-10"><a href="#cb135-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb135-11"><a href="#cb135-11" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb135-12"><a href="#cb135-12" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb135-13"><a href="#cb135-13" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb135-14"><a href="#cb135-14" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="question3-4" class="section level2">
<h2>Question3</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\widehat{a}  &lt; 1.2\)</span>.</p>
</div>
<div id="answer3-4" class="section level2">
<h2>Answer3</h2>
<p>In Question1:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="cf">function</span>(i) <span class="fu">M_H</span>(N, initial_value))</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>mcmc_chains <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">lapply</span>(chains, as.mcmc))</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>gelman_diag <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(mcmc_chains)</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a><span class="fu">print</span>(gelman_diag)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.08       1.14</code></pre>
<p>We can see that <span class="math inline">\(\widehat{R}\)</span> is
less than 1.2.It can be considered that Markov chains converge.</p>
<p>In Question2:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, k)</span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a>  </span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb138-9"><a href="#cb138-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb138-10"><a href="#cb138-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb138-11"><a href="#cb138-11" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb138-12"><a href="#cb138-12" tabindex="-1"></a>  }</span>
<span id="cb138-13"><a href="#cb138-13" tabindex="-1"></a>  chains[[j]] <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(samples)</span>
<span id="cb138-14"><a href="#cb138-14" tabindex="-1"></a>}</span>
<span id="cb138-15"><a href="#cb138-15" tabindex="-1"></a>gelman_diag <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(<span class="fu">mcmc.list</span>(chains))</span>
<span id="cb138-16"><a href="#cb138-16" tabindex="-1"></a><span class="fu">print</span>(gelman_diag)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1
## [2,]          1          1
## 
## Multivariate psrf
## 
## 1</code></pre>
<p>We can see that all <span class="math inline">\(\widehat{R}\)</span>
are less than 1.1.It can be considered that Markov chains converge</p>
</div>
</div>
<div id="section-7" class="section level1">
<h1>2024.11.04</h1>
<div id="question1-5" class="section level2">
<h2>Question1</h2>
<p>Exercises 11.3 (a) Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[\sum_{k=0}^\infty\frac{(-1)^k}{k!
2^k}\frac{\left\|a\right\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},\]</span>
where d ≥ 1 is an integer, a is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\left \| \cdot  \right \|\)</span>denotes the
Euclidean norm. Perform the arithmetic so that the coefficients can be
computed for (almost) arbitrarily large k and d. (This sum converges for
all <span class="math inline">\(a\in R^{d}\)</span>) (b) Modify the
function so that it computes and returns the sum. (c) Evaluate the sum
when a = <span class="math inline">\((1, 2)^T\)</span> .</p>
</div>
<div id="answer1-6" class="section level2">
<h2>Answer1</h2>
<p>(a)Let’s assume <span class="math display">\[a_k = \frac{(-1)^k}{k!
2^k}\frac{\left\|a\right\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}\]</span>
<span class="math display">\[c_k=\frac{1}{k!
2^k}\frac{\left\|a\right\|^{2k+2}}{(2k+1)(2k+2)}=exp\left \{  \left (
k+1 \right ) \log{\left \| a \right \| ^2} -klog2-log\left ( 2k+1 \right
) -log\left ( 2k+2 \right )-\sum_{i=1}^{k}log\left ( i \right ) \right
\} \]</span> <span class="math display">\[d_k=\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}=exp\left
\{ log\Gamma\left(\frac{d+1}{2}\right)+log\Gamma\left({k+\frac{3}{2}
}\right)-log\Gamma\left({k+\frac{d}{2}+1 }\right) \right \}\]</span>
<span class="math display">\[a_k=(-1)^k*c_k*d_k\]</span> We can use
function a_k to compute the <span class="math inline">\(k^{th}\)</span>
term.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a>  l <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,k,<span class="dv">1</span>)</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(s))</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(l)<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">-</span>r</span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(m))</span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a>}</span>
<span id="cb140-8"><a href="#cb140-8" tabindex="-1"></a>d_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb140-9"><a href="#cb140-9" tabindex="-1"></a>   d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb140-10"><a href="#cb140-10" tabindex="-1"></a>   n <span class="ot">&lt;-</span> <span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb140-11"><a href="#cb140-11" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">exp</span>(n))</span>
<span id="cb140-12"><a href="#cb140-12" tabindex="-1"></a>}</span>
<span id="cb140-13"><a href="#cb140-13" tabindex="-1"></a>a_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k,a){</span>
<span id="cb140-14"><a href="#cb140-14" tabindex="-1"></a>  t <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>(k)<span class="sc">*</span><span class="fu">c_k</span>(k,a)<span class="sc">*</span><span class="fu">d_k</span>(k,a)</span>
<span id="cb140-15"><a href="#cb140-15" tabindex="-1"></a>  <span class="fu">return</span>(t)</span>
<span id="cb140-16"><a href="#cb140-16" tabindex="-1"></a>}</span></code></pre></div>
<p>(b)We only need to sum each function a_k to get the result.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>S_n <span class="ot">&lt;-</span> <span class="cf">function</span>(n,a){</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>    t[i] <span class="ot">&lt;-</span> <span class="fu">a_k</span>(i,a)</span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>}</span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>s0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">gamma</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">gamma</span>((d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a>ss <span class="ot">&lt;-</span> <span class="fu">sum</span>(t)<span class="sc">+</span>s0</span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a><span class="fu">return</span>(ss)</span>
<span id="cb141-10"><a href="#cb141-10" tabindex="-1"></a>}</span></code></pre></div>
<p>(c)We can evaluate the sum when a = <span class="math inline">\((1,
2)^T\)</span> and n = 100.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb142-3"><a href="#cb142-3" tabindex="-1"></a><span class="fu">S_n</span>(n,a)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
<div id="question2-6" class="section level2">
<h2>Question2</h2>
<p>Exercises 11.5 Write a function to solve the equation <span class="math display">\[\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k/2}du\\=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi
k}\Gamma(\frac{k}{2})}\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1)/2}du\]</span>
for a, where <span class="math display">\[c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.\]</span> Compare
the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer2-6" class="section level2">
<h2>Answer2</h2>
<p>First of all, we can equivalent the equation to: <span class="math display">\[\sqrt{k}\Gamma^2(\frac{k}{2})\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k/2}du-\sqrt{(k-1)}\Gamma(\frac{k+1}{2})\Gamma(\frac{k-1}{2})\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1)/2}du=0\]</span></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="cf">function</span> (k) {g.integral <span class="ot">=</span> <span class="cf">function</span>(u, n) {</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>}</span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>l <span class="ot">=</span> <span class="cf">function</span> (n, a) {</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> (n <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>}</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (n, a) {</span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a>    q.integral <span class="ot">=</span> <span class="cf">function</span> (u) {<span class="fu">g.integral</span>(u, n)}</span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a>    c <span class="ot">=</span> <span class="fu">l</span>(n <span class="sc">-</span> <span class="dv">1</span>, a)</span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(pi<span class="sc">*</span>(n<span class="dv">-1</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(n<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>((n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">integrate</span>(q.integral, <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c)<span class="sc">$</span>value}</span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a>  f <span class="ot">=</span> <span class="cf">function</span> (a) {</span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a>    t1 <span class="ot">=</span> <span class="fu">g</span>(k, a)</span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a>    t2 <span class="ot">=</span> <span class="fu">g</span>(k <span class="sc">+</span> <span class="dv">1</span>, a)</span>
<span id="cb144-14"><a href="#cb144-14" tabindex="-1"></a>    <span class="fu">return</span> (t1 <span class="sc">-</span> t2)</span>
<span id="cb144-15"><a href="#cb144-15" tabindex="-1"></a>  }</span>
<span id="cb144-16"><a href="#cb144-16" tabindex="-1"></a>  </span>
<span id="cb144-17"><a href="#cb144-17" tabindex="-1"></a>  tol <span class="ot">=</span> <span class="fl">1e-2</span></span>
<span id="cb144-18"><a href="#cb144-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">f</span>(tol) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">f</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> tol) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">||</span> <span class="fu">f</span>(tol) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">f</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> tol) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb144-19"><a href="#cb144-19" tabindex="-1"></a>    r <span class="ot">=</span> <span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(tol, <span class="fu">sqrt</span>(k)<span class="sc">-</span>tol))<span class="sc">$</span>root</span>
<span id="cb144-20"><a href="#cb144-20" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb144-21"><a href="#cb144-21" tabindex="-1"></a>    r <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb144-22"><a href="#cb144-22" tabindex="-1"></a>  }</span>
<span id="cb144-23"><a href="#cb144-23" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb144-24"><a href="#cb144-24" tabindex="-1"></a>}</span>
<span id="cb144-25"><a href="#cb144-25" tabindex="-1"></a></span>
<span id="cb144-26"><a href="#cb144-26" tabindex="-1"></a>s<span class="ot">=</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">20</span>), <span class="cf">function</span> (k) {</span>
<span id="cb144-27"><a href="#cb144-27" tabindex="-1"></a>  <span class="fu">m</span>(k)</span>
<span id="cb144-28"><a href="#cb144-28" tabindex="-1"></a>})</span>
<span id="cb144-29"><a href="#cb144-29" tabindex="-1"></a>s</span></code></pre></div>
<pre><code>##  [1] 1.533555 1.562745 1.584429 1.601184 1.614516 1.625389 1.634418 1.642026
##  [9] 1.648552 1.654175 1.659099 1.663454 1.667287       NA 1.673832 1.676605</code></pre>
<p>We can get the above results by using the existing code in the online
community.</p>
</div>
<div id="question3-5" class="section level2">
<h2>Question3</h2>
<p>Suppose <span class="math inline">\(T_i,\ldots,T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
λ. Those values greater than <span class="math inline">\(\tau\)</span>
are not observed due to right censorship, so that the observed values
are <span class="math display">\[Y_i=T_iI(T_i\leq\tau)+\tau
I(T_i&gt;\tau),i=1,\ldots,n.\]</span> Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: 0.54, 0.48,
0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85 Use the E-M algorithm to
estimate <span class="math inline">\(\lambda\)</span>, compare your
result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer3-5" class="section level2">
<h2>Answer3</h2>
<p>Complete data likelihood: <span class="math display">\[l\left (
\lambda \mid Y_i \right ) =n\log{\lambda } -\lambda \left (
\sum_{i=1}^{n} T_i \right )\]</span> <span class="math display">\[l\left
( \lambda \mid Y_i \right ) =n\log{\lambda } -\lambda \left (
\sum_{i=1}^{n} Y_i+\sum_{i=1}^{n} (T_i-1) I\left ( T_i &gt;1 \right
)  \right )\]</span> E-step:</p>
<p><span class="math display">\[E\left ( T_i \mid T_{i} &gt; 1 \right
)=1+\frac{1}{\lambda_0 }\]</span> <span class="math display">\[E_{\hat{\lambda } }\left [ l\left ( \lambda \mid
Y_i \right ) \right ] =n\log{\lambda } -\lambda \left ( \sum_{i=1}^{n}
Y_i+ n_1 \frac{1}{\lambda_0 }   \right )\]</span> where <span class="math inline">\(n_1=\sum_{i=1}^{n} Y_i I\left ( Y_i = 1
\right)\)</span></p>
<p>M-step:</p>
<p><span class="math display">\[\hat{\lambda_1 } =\frac{1}{\overline{Y}
-\frac{n_1}{n\lambda _0} } \]</span></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span>  </span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>tol <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a><span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>  m <span class="ot">&lt;-</span> Y[Y <span class="sc">&lt;</span> tau]</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> Y[Y <span class="sc">&gt;=</span> tau]</span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a>  E <span class="ot">&lt;-</span> tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda  </span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> <span class="fu">length</span>(Y) <span class="sc">/</span> (<span class="fu">sum</span>(m) <span class="sc">+</span> <span class="fu">length</span>(n) <span class="sc">*</span> E)</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb146-14"><a href="#cb146-14" tabindex="-1"></a>  }</span>
<span id="cb146-15"><a href="#cb146-15" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb146-16"><a href="#cb146-16" tabindex="-1"></a>}</span>
<span id="cb146-17"><a href="#cb146-17" tabindex="-1"></a>lambda</span></code></pre></div>
<pre><code>## [1] 1.037037</code></pre>
<p>We got a good estimate of <span class="math inline">\(\lambda\)</span>.</p>
</div>
</div>
<div id="section-8" class="section level1">
<h1>2024.11.11</h1>
<div id="question1-6" class="section level2">
<h2>Question1</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4x + 2y + 9z\)</span> subject to <span class="math display">\[2x + y + z ≤ 2\]</span> <span class="math display">\[x − y + 3z ≤ 3\]</span> <span class="math display">\[x ≥ 0, y ≥ 0, z ≥ 0\]</span></p>
</div>
<div id="answer1-7" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#for simplex function</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">9</span>)</span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a><span class="fu">simplex</span>(<span class="at">a=</span>a,<span class="at">A1=</span>A1,<span class="at">b1=</span>b1,<span class="at">maxi =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Linear Programming Results
## 
## Call : simplex(a = a, A1 = A1, b1 = b1, maxi = FALSE)
## 
## Minimization Problem with Objective Function Coefficients
## x1 x2 x3 
##  4  2  9 
## 
## 
## Optimal solution has the following values
## x1 x2 x3 
##  0  0  0 
## The optimal value of the objective  function is 0.</code></pre>
<p>We can see the equation gets the minimum value of 0 when x=y=z=0.</p>
</div>
<div id="question2-7" class="section level2">
<h2>Question2</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb150-3"><a href="#cb150-3" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb150-4"><a href="#cb150-4" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb150-5"><a href="#cb150-5" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb150-6"><a href="#cb150-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="answer2-7" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb151-5"><a href="#cb151-5" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb151-6"><a href="#cb151-6" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb151-7"><a href="#cb151-7" tabindex="-1"></a>)</span>
<span id="cb151-8"><a href="#cb151-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> formulas) {</span>
<span id="cb151-9"><a href="#cb151-9" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">lm</span>(i,mtcars)</span>
<span id="cb151-10"><a href="#cb151-10" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(y))</span>
<span id="cb151-11"><a href="#cb151-11" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10
## 
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7383 -1.8216 -0.0751  1.0487  4.6105 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***
## I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.295 on 30 degrees of freedom
## Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 
## F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14
## 
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10
## 
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7085 -1.5121 -0.6191  1.5142  4.2314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***
## I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***
## wt            -1.7976     0.7327  -2.453   0.0204 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.124 on 29 degrees of freedom
## Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 
## F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(i) <span class="fu">lm</span>(i, <span class="at">data =</span> mtcars))</span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a><span class="fu">lapply</span>(models, summary)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10
## 
## 
## [[2]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7383 -1.8216 -0.0751  1.0487  4.6105 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***
## I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.295 on 30 degrees of freedom
## Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 
## F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14
## 
## 
## [[3]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10
## 
## 
## [[4]]
## 
## Call:
## lm(formula = i, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7085 -1.5121 -0.6191  1.5142  4.2314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***
## I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***
## wt            -1.7976     0.7327  -2.453   0.0204 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.124 on 29 degrees of freedom
## Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 
## F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</code></pre>
</div>
<div id="question3-6" class="section level2">
<h2>Question3</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply().Can you do it
without an anonymous function?</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb155-4"><a href="#cb155-4" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="answer3-6" class="section level2">
<h2>Answer3</h2>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a>  mtcars[i, ]</span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a>}</span>
<span id="cb156-6"><a href="#cb156-6" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) <span class="fu">f</span>())</span>
<span id="cb156-7"><a href="#cb156-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb156-8"><a href="#cb156-8" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb156-9"><a href="#cb156-9" tabindex="-1"></a>}</span>
<span id="cb156-10"><a href="#cb156-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb156-11"><a href="#cb156-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bootstraps)) {</span>
<span id="cb156-12"><a href="#cb156-12" tabindex="-1"></a>  x[[i]] <span class="ot">&lt;-</span> <span class="fu">m</span>(bootstraps[[i]])</span>
<span id="cb156-13"><a href="#cb156-13" tabindex="-1"></a>}</span>
<span id="cb156-14"><a href="#cb156-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, m)</span>
<span id="cb156-15"><a href="#cb156-15" tabindex="-1"></a><span class="fu">lapply</span>(x, summary)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.6189 -2.3467 -0.1747  3.0124  6.3265 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.634441   1.100187  27.845  &lt; 2e-16 ***
## disp        -0.043052   0.004332  -9.938 5.28e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.188 on 30 degrees of freedom
## Multiple R-squared:  0.767,  Adjusted R-squared:  0.7593 
## F-statistic: 98.77 on 1 and 30 DF,  p-value: 5.284e-11
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5136 -2.9261 -0.9017  1.2633  7.2947 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.767364   1.276013  23.328  &lt; 2e-16 ***
## disp        -0.044473   0.005732  -7.758 1.18e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.458 on 30 degrees of freedom
## Multiple R-squared:  0.6674, Adjusted R-squared:  0.6563 
## F-statistic: 60.19 on 1 and 30 DF,  p-value: 1.176e-08
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.083 -2.426 -1.137  2.736  7.224 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.470332   1.217875   24.20  &lt; 2e-16 ***
## disp        -0.039302   0.005019   -7.83 9.75e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.445 on 30 degrees of freedom
## Multiple R-squared:  0.6714, Adjusted R-squared:  0.6605 
## F-statistic: 61.31 on 1 and 30 DF,  p-value: 9.75e-09
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.959 -2.387 -1.200  1.566  7.210 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.586780   1.157256  25.566  &lt; 2e-16 ***
## disp        -0.040737   0.004775  -8.532 1.61e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.394 on 30 degrees of freedom
## Multiple R-squared:  0.7082, Adjusted R-squared:  0.6984 
## F-statistic: 72.79 on 1 and 30 DF,  p-value: 1.609e-09
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2571 -1.7412 -0.8305  1.7743  6.8625 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 28.61846    1.06948  26.759  &lt; 2e-16 ***
## disp        -0.03915    0.00430  -9.104 3.88e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.767 on 30 degrees of freedom
## Multiple R-squared:  0.7343, Adjusted R-squared:  0.7254 
## F-statistic: 82.89 on 1 and 30 DF,  p-value: 3.883e-10
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2322 -2.2500 -0.6838  1.6558  6.6070 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.526375   1.072892   28.45  &lt; 2e-16 ***
## disp        -0.045477   0.004528  -10.04 4.13e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.988 on 30 degrees of freedom
## Multiple R-squared:  0.7708, Adjusted R-squared:  0.7631 
## F-statistic: 100.9 on 1 and 30 DF,  p-value: 4.13e-11
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.8094 -2.8099 -0.0798  2.9983  6.2717 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.589467   1.506445  20.306  &lt; 2e-16 ***
## disp        -0.041647   0.005508  -7.561 1.98e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.646 on 30 degrees of freedom
## Multiple R-squared:  0.6559, Adjusted R-squared:  0.6444 
## F-statistic: 57.17 on 1 and 30 DF,  p-value: 1.975e-08
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3390 -1.5883  0.0432  0.9341  6.8620 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.928359   0.952737   32.46  &lt; 2e-16 ***
## disp        -0.046476   0.003865  -12.03  5.3e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.697 on 30 degrees of freedom
## Multiple R-squared:  0.8282, Adjusted R-squared:  0.8225 
## F-statistic: 144.6 on 1 and 30 DF,  p-value: 5.298e-13
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1498 -1.6565 -0.8047  1.0462  8.2543 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 28.335693   1.029729  27.518  &lt; 2e-16 ***
## disp        -0.037833   0.004128  -9.164 3.35e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.63 on 30 degrees of freedom
## Multiple R-squared:  0.7368, Adjusted R-squared:  0.728 
## F-statistic: 83.99 on 1 and 30 DF,  p-value: 3.353e-10
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.682 -2.454 -1.050  2.166  6.929 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.277348   1.307908   23.15  &lt; 2e-16 ***
## disp        -0.046510   0.006104   -7.62 1.69e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.439 on 30 degrees of freedom
## Multiple R-squared:  0.6593, Adjusted R-squared:  0.648 
## F-statistic: 58.06 on 1 and 30 DF,  p-value: 1.692e-08</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="fu">lapply</span>(y, summary)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.6189 -2.3467 -0.1747  3.0124  6.3265 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.634441   1.100187  27.845  &lt; 2e-16 ***
## disp        -0.043052   0.004332  -9.938 5.28e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.188 on 30 degrees of freedom
## Multiple R-squared:  0.767,  Adjusted R-squared:  0.7593 
## F-statistic: 98.77 on 1 and 30 DF,  p-value: 5.284e-11
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5136 -2.9261 -0.9017  1.2633  7.2947 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.767364   1.276013  23.328  &lt; 2e-16 ***
## disp        -0.044473   0.005732  -7.758 1.18e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.458 on 30 degrees of freedom
## Multiple R-squared:  0.6674, Adjusted R-squared:  0.6563 
## F-statistic: 60.19 on 1 and 30 DF,  p-value: 1.176e-08
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -5.083 -2.426 -1.137  2.736  7.224 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.470332   1.217875   24.20  &lt; 2e-16 ***
## disp        -0.039302   0.005019   -7.83 9.75e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.445 on 30 degrees of freedom
## Multiple R-squared:  0.6714, Adjusted R-squared:  0.6605 
## F-statistic: 61.31 on 1 and 30 DF,  p-value: 9.75e-09
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.959 -2.387 -1.200  1.566  7.210 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.586780   1.157256  25.566  &lt; 2e-16 ***
## disp        -0.040737   0.004775  -8.532 1.61e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.394 on 30 degrees of freedom
## Multiple R-squared:  0.7082, Adjusted R-squared:  0.6984 
## F-statistic: 72.79 on 1 and 30 DF,  p-value: 1.609e-09
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2571 -1.7412 -0.8305  1.7743  6.8625 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 28.61846    1.06948  26.759  &lt; 2e-16 ***
## disp        -0.03915    0.00430  -9.104 3.88e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.767 on 30 degrees of freedom
## Multiple R-squared:  0.7343, Adjusted R-squared:  0.7254 
## F-statistic: 82.89 on 1 and 30 DF,  p-value: 3.883e-10
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2322 -2.2500 -0.6838  1.6558  6.6070 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.526375   1.072892   28.45  &lt; 2e-16 ***
## disp        -0.045477   0.004528  -10.04 4.13e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.988 on 30 degrees of freedom
## Multiple R-squared:  0.7708, Adjusted R-squared:  0.7631 
## F-statistic: 100.9 on 1 and 30 DF,  p-value: 4.13e-11
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.8094 -2.8099 -0.0798  2.9983  6.2717 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.589467   1.506445  20.306  &lt; 2e-16 ***
## disp        -0.041647   0.005508  -7.561 1.98e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.646 on 30 degrees of freedom
## Multiple R-squared:  0.6559, Adjusted R-squared:  0.6444 
## F-statistic: 57.17 on 1 and 30 DF,  p-value: 1.975e-08
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.3390 -1.5883  0.0432  0.9341  6.8620 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.928359   0.952737   32.46  &lt; 2e-16 ***
## disp        -0.046476   0.003865  -12.03  5.3e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.697 on 30 degrees of freedom
## Multiple R-squared:  0.8282, Adjusted R-squared:  0.8225 
## F-statistic: 144.6 on 1 and 30 DF,  p-value: 5.298e-13
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1498 -1.6565 -0.8047  1.0462  8.2543 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 28.335693   1.029729  27.518  &lt; 2e-16 ***
## disp        -0.037833   0.004128  -9.164 3.35e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.63 on 30 degrees of freedom
## Multiple R-squared:  0.7368, Adjusted R-squared:  0.728 
## F-statistic: 83.99 on 1 and 30 DF,  p-value: 3.353e-10
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.682 -2.454 -1.050  2.166  6.929 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 30.277348   1.307908   23.15  &lt; 2e-16 ***
## disp        -0.046510   0.006104   -7.62 1.69e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.439 on 30 degrees of freedom
## Multiple R-squared:  0.6593, Adjusted R-squared:  0.648 
## F-statistic: 58.06 on 1 and 30 DF,  p-value: 1.692e-08</code></pre>
</div>
<div id="question4-2" class="section level2">
<h2>Question4</h2>
<p>For each model in the previous two exercises, extract R2 using the
function below.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="answer4-2" class="section level2">
<h2>Answer4</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x, rsq)</span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(y, rsq)</span>
<span id="cb161-4"><a href="#cb161-4" tabindex="-1"></a><span class="fu">print</span>(x1)</span></code></pre></div>
<pre><code>##  [1] 0.7670254 0.6673648 0.6714435 0.7081550 0.7342509 0.7707854 0.6558560
##  [8] 0.8281776 0.7368100 0.6593271</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" tabindex="-1"></a><span class="fu">print</span>(y1)</span></code></pre></div>
<pre><code>##  [1] 0.7670254 0.6673648 0.6714435 0.7081550 0.7342509 0.7707854 0.6558560
##  [8] 0.8281776 0.7368100 0.6593271</code></pre>
</div>
<div id="quesyion5" class="section level2">
<h2>Quesyion5</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb165-3"><a href="#cb165-3" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb165-4"><a href="#cb165-4" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb165-5"><a href="#cb165-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[
directly.</p>
</div>
<div id="answer5" class="section level2">
<h2>Answer5</h2>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a>)</span>
<span id="cb166-6"><a href="#cb166-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>,<span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb166-7"><a href="#cb166-7" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<pre><code>##   [1] 0.48099661 0.30115363 0.77182131 0.62655206 0.13350859 0.63021781
##   [7] 0.34087743 0.29053088 0.15009086 0.64782138 0.23399009 0.70864793
##  [13] 0.33341485 0.62860452 0.15088042 0.28476481 0.71507482 0.51147899
##  [19] 0.76320234 0.92024509 0.64736271 0.44351097 0.05072744 0.42300864
##  [25] 0.74614718 0.06345318 0.52604030 0.54937291 0.19880453 0.87692404
##  [31] 0.60205932 0.92128410 0.08542684 0.89900032 0.93324453 0.82319765
##  [37] 0.40160545 0.74483116 0.48835086 0.92857659 0.27635353 0.68338380
##  [43] 0.15319369 0.27403576 0.58185594 0.84035931 0.51569707 0.30500118
##  [49] 0.46980523 0.75706933 0.33521500 0.83723761 0.54637726 0.55765421
##  [55] 0.11265016 0.50900746 0.75380862 0.72300561 0.22889403 0.69537962
##  [61] 0.08623531 0.33044354 0.38035677 0.41297147 0.88798136 0.97913205
##  [67] 0.29564184 0.73235677 0.51168373 0.57985531 0.83683736 0.39737266
##  [73] 0.42089883 0.94745731 0.79270387 0.26429823 0.08153552 0.66540919
##  [79] 0.94783840 0.94919718 0.51813684 0.95216460 0.50095111 0.04372492
##  [85] 0.54303024 0.56339184 0.29410775 0.21250647 0.51616848 0.88813328
##  [91] 0.12355202 0.34048979 0.38757177 0.71730190 0.62518842 0.71789918
##  [97] 0.82354358 0.52565981 0.29509798 0.76476200</code></pre>
</div>
<div id="quesyion6" class="section level2">
<h2>Quesyion6</h2>
<p>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
</div>
<div id="answer6" class="section level2">
<h2>Answer6</h2>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., <span class="at">simplify =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb168-3"><a href="#cb168-3" tabindex="-1"></a>  <span class="fu">vapply</span>(results, identity, <span class="at">FUN.VALUE =</span> simplify)</span>
<span id="cb168-4"><a href="#cb168-4" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="quesyion7" class="section level2">
<h2>Quesyion7</h2>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test" class="uri">http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test</a>).
## Answer7</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y) <span class="sc">||</span> <span class="fu">anyNA</span>(x) <span class="sc">||</span> <span class="fu">anyNA</span>(y)) {</span>
<span id="cb169-3"><a href="#cb169-3" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb169-4"><a href="#cb169-4" tabindex="-1"></a>  }</span>
<span id="cb169-5"><a href="#cb169-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb169-6"><a href="#cb169-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">rowSums</span>(m), <span class="fu">colSums</span>(m)) <span class="sc">/</span> <span class="fu">sum</span>(m)</span>
<span id="cb169-7"><a href="#cb169-7" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">sum</span>((m <span class="sc">-</span> n)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> n)</span>
<span id="cb169-8"><a href="#cb169-8" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb169-9"><a href="#cb169-9" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="quesyion8" class="section level2">
<h2>Quesyion8</h2>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
</div>
<div id="answer8" class="section level2">
<h2>Answer8</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y) <span class="sc">||</span> <span class="fu">anyNA</span>(x) <span class="sc">||</span> <span class="fu">anyNA</span>(y)) {</span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a>  }</span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(x))), <span class="at">ncol =</span> <span class="fu">length</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(y))),</span>
<span id="cb170-6"><a href="#cb170-6" tabindex="-1"></a>                         <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(x)), <span class="fu">sort</span>(<span class="fu">unique</span>(y))))</span>
<span id="cb170-7"><a href="#cb170-7" tabindex="-1"></a>  </span>
<span id="cb170-8"><a href="#cb170-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb170-9"><a href="#cb170-9" tabindex="-1"></a>    m[<span class="fu">as.character</span>(x[i]), <span class="fu">as.character</span>(y[i])] <span class="ot">&lt;-</span> m[<span class="fu">as.character</span>(x[i]), <span class="fu">as.character</span>(y[i])] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb170-10"><a href="#cb170-10" tabindex="-1"></a>  }</span>
<span id="cb170-11"><a href="#cb170-11" tabindex="-1"></a>  </span>
<span id="cb170-12"><a href="#cb170-12" tabindex="-1"></a>  <span class="fu">return</span>(m)</span>
<span id="cb170-13"><a href="#cb170-13" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="section-9" class="section level1">
<h1>2024.11.18</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p><span class="math display">\[f(x,y)\propto\binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad
x=0,1,\ldots,n,\:0\leq y\leq1.\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are
Binomial<span class="math inline">\((n,y)\)</span> and Beta<span class="math inline">\((x+a,n-x+b).\)</span> Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y).\)</span></p>
</div>
<div id="answer1-8" class="section level2">
<h2>Answer1</h2>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  </span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span>   </span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>   </span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span> </span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a></span>
<span id="cb171-6"><a href="#cb171-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb171-7"><a href="#cb171-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb171-8"><a href="#cb171-8" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="dv">1</span>) </span>
<span id="cb171-9"><a href="#cb171-9" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb171-10"><a href="#cb171-10" tabindex="-1"></a></span>
<span id="cb171-11"><a href="#cb171-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb171-12"><a href="#cb171-12" tabindex="-1"></a>  </span>
<span id="cb171-13"><a href="#cb171-13" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> x[i<span class="dv">-1</span>] <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> x[i<span class="dv">-1</span>] <span class="sc">+</span> b)</span>
<span id="cb171-14"><a href="#cb171-14" tabindex="-1"></a>  </span>
<span id="cb171-15"><a href="#cb171-15" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> y[i])</span>
<span id="cb171-16"><a href="#cb171-16" tabindex="-1"></a>}</span>
<span id="cb171-17"><a href="#cb171-17" tabindex="-1"></a></span>
<span id="cb171-18"><a href="#cb171-18" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">main =</span> <span class="st">&quot;Gibbs Sampler&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question2-8" class="section level2">
<h2>Question2</h2>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer2-8" class="section level2">
<h2>Answer2</h2>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a></span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a>gibbs_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a>gibbs_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb174-8"><a href="#cb174-8" tabindex="-1"></a>gibbs_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="dv">1</span>)</span>
<span id="cb174-9"><a href="#cb174-9" tabindex="-1"></a>gibbs_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb174-10"><a href="#cb174-10" tabindex="-1"></a></span>
<span id="cb174-11"><a href="#cb174-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb174-12"><a href="#cb174-12" tabindex="-1"></a>  gibbs_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> gibbs_x[i<span class="dv">-1</span>] <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> gibbs_x[i<span class="dv">-1</span>] <span class="sc">+</span> b)</span>
<span id="cb174-13"><a href="#cb174-13" tabindex="-1"></a>  gibbs_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> gibbs_y[i])</span>
<span id="cb174-14"><a href="#cb174-14" tabindex="-1"></a>}</span>
<span id="cb174-15"><a href="#cb174-15" tabindex="-1"></a></span>
<span id="cb174-16"><a href="#cb174-16" tabindex="-1"></a>direct_y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(iterations, <span class="at">shape1 =</span> a, <span class="at">shape2 =</span> n <span class="sc">+</span> b <span class="sc">-</span> a)</span>
<span id="cb174-17"><a href="#cb174-17" tabindex="-1"></a>direct_x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(iterations, <span class="at">size =</span> n, <span class="at">prob =</span> direct_y)</span>
<span id="cb174-18"><a href="#cb174-18" tabindex="-1"></a></span>
<span id="cb174-19"><a href="#cb174-19" tabindex="-1"></a><span class="fu">qqplot</span>(gibbs_y, direct_y, <span class="at">main =</span> <span class="st">&quot;Gibbs采样与直接采样的y分布QQ-图&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Gibbs采样器&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;直接采样&quot;</span>)</span>
<span id="cb174-20"><a href="#cb174-20" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="fu">qqplot</span>(gibbs_x, direct_x, <span class="at">main =</span> <span class="st">&quot;Gibbs采样与直接采样的x分布QQ-图&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Gibbs采样器&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;直接采样&quot;</span>)</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a>gibbs_time <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>({</span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a>  gibbs_x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a>  gibbs_y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb176-4"><a href="#cb176-4" tabindex="-1"></a>  gibbs_x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="dv">1</span>)</span>
<span id="cb176-5"><a href="#cb176-5" tabindex="-1"></a>  gibbs_y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb176-6"><a href="#cb176-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb176-7"><a href="#cb176-7" tabindex="-1"></a>    gibbs_y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> gibbs_x[i<span class="dv">-1</span>] <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> gibbs_x[i<span class="dv">-1</span>] <span class="sc">+</span> b)</span>
<span id="cb176-8"><a href="#cb176-8" tabindex="-1"></a>    gibbs_x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> gibbs_y[i])</span>
<span id="cb176-9"><a href="#cb176-9" tabindex="-1"></a>  }</span>
<span id="cb176-10"><a href="#cb176-10" tabindex="-1"></a>}, <span class="at">times =</span> <span class="dv">10</span>)</span>
<span id="cb176-11"><a href="#cb176-11" tabindex="-1"></a></span>
<span id="cb176-12"><a href="#cb176-12" tabindex="-1"></a>direct_time <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>({</span>
<span id="cb176-13"><a href="#cb176-13" tabindex="-1"></a>  direct_y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(iterations, <span class="at">shape1 =</span> a, <span class="at">shape2 =</span> n <span class="sc">+</span> b <span class="sc">-</span> a)</span>
<span id="cb176-14"><a href="#cb176-14" tabindex="-1"></a>  direct_x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(iterations, <span class="at">size =</span> n, <span class="at">prob =</span> direct_y)</span>
<span id="cb176-15"><a href="#cb176-15" tabindex="-1"></a>}, <span class="at">times =</span> <span class="dv">10</span>)</span>
<span id="cb176-16"><a href="#cb176-16" tabindex="-1"></a></span>
<span id="cb176-17"><a href="#cb176-17" tabindex="-1"></a><span class="fu">print</span>(gibbs_time)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                                                                                                                                                                                                                                                                                                                                              expr
##  {     gibbs_x &lt;- numeric(iterations)     gibbs_y &lt;- numeric(iterations)     gibbs_x[1] &lt;- sample(0:n, 1)     gibbs_y[1] &lt;- runif(1)     for (i in 2:iterations) {         gibbs_y[i] &lt;- rbeta(1, shape1 = gibbs_x[i - 1] + a, shape2 = n -              gibbs_x[i - 1] + b)         gibbs_x[i] &lt;- rbinom(1, size = n, prob = gibbs_y[i])     } }
##      min      lq     mean  median     uq     max neval
##  28.5413 28.7762 31.08269 29.7519 32.508 35.8608    10</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="fu">print</span>(direct_time)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##                                                                                                                                          expr
##  {     direct_y &lt;- rbeta(iterations, shape1 = a, shape2 = n + b -          a)     direct_x &lt;- rbinom(iterations, size = n, prob = direct_y) }
##       min       lq     mean   median       uq      max neval
##  2.833701 2.837902 2.864351 2.844951 2.905801 2.927201    10</code></pre>
<p>We can see the QQ-plot will show how closely the distribution of the
output from the Gibbs sampler corresponds to that of the direct
sampling. If the points are roughly aligned along the red line (y=x),
this indicates that the distributions are similar.</p>
<p>Direct sampling is faster because it avoids the iterative process
inherent in Gibbs sampling, which requires multiple steps for each
iteration.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
